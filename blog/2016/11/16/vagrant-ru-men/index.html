
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Vagrant 入门 - Sean's Blog</title>
  <meta name="author" content="Sean Guo">

  
  <meta name="description" content="介绍 Vagrant是一个虚拟机管理工具，通过它你可以用几个简单的命令快速搭建一个配置好的虚拟机环境。它提供了多种虚拟机provider所以你可以用同一个设置文件去驱动设置不同的虚拟机。
它的核心文件叫做Vagrantfile，所有的虚拟机的配置都是在这里。 &hellip;">
  <meta name="keywords" content="vagrant">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.seanguo.com/blog/2016/11/16/vagrant-ru-men">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Sean's Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Sean's Blog</a></h1>
  
    <h2>Basically technique.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.seanguo.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Vagrant 入门</h1>
    
    
      <p class="meta">
        








  


<time datetime="2016-11-16T11:48:43+08:00" pubdate data-updated="true">Nov 16<span>th</span>, 2016</time>
        
           | <a href="#disqus_thread"
             data-disqus-identifier="http://www.seanguo.com">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><h2>介绍</h2>

<p>Vagrant是一个虚拟机管理工具，通过它你可以用几个简单的命令快速搭建一个配置好的虚拟机环境。它提供了多种虚拟机provider所以你可以用同一个设置文件去驱动设置不同的虚拟机。<br><br>
它的核心文件叫做Vagrantfile，所有的虚拟机的配置都是在这里。我们可以在里面定义各个provider的配置，如果去用provisioner去设置虚拟机，安装应用程序。有了这个配置文件，你就可以很方便的快速重复构建一个测试环境。这让Docker出现之前成为了开发员很热衷的一个环境设置工具。
我这篇文章将会一步一步来搭建一个测试环境。这样从头来讲解Vagrant的基本使用方法，希望可以帮到那些想要学习Vagrant的人。</p>

<h2>初始设置</h2>

<p>首先你需要去<a href="https://www.vagrantup.com/downloads.html">下载</a>适合你操作系统的Vagrant安装包。安装完之后我们还需要安装<a href="https://www.virtualbox.org/">VirtualBox</a>来作为演示用的provider。因为Virtualbox是Vagrant的provider，当然当你熟悉Vagrant之后可以通过修改全局的配置文件来修改默认的provider。一切都安装好了之后我们需要打开一个shell窗口，新建一个文件夹作为这次演示用的。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mkdir vagrant_leanring
</span><span class='line'><span class="nb">cd </span>vagrant_leanring
</span><span class='line'>vagrant init
</span></code></pre></td></tr></table></div></figure>


<p>这里用到了第一个命令 <em>vagrant init</em> 这个命令会在当然目录生成如下这样的一个Vagrantfile，我们可以以这个为模板来修改运行我们自己的演示。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># -*- mode: ruby -*-</span>
</span><span class='line'><span class="c1"># vi: set ft=ruby :</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># All Vagrant configuration is done below. The &quot;2&quot; in Vagrant.configure</span>
</span><span class='line'><span class="c1"># configures the configuration version (we support older styles for</span>
</span><span class='line'><span class="c1"># backwards compatibility). Please don&#39;t change it unless you know what</span>
</span><span class='line'><span class="c1"># you&#39;re doing.</span>
</span><span class='line'><span class="no">Vagrant</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
</span><span class='line'>  <span class="c1"># The most common configuration options are documented and commented below.</span>
</span><span class='line'>  <span class="c1"># For a complete reference, please see the online documentation at</span>
</span><span class='line'>  <span class="c1"># https://docs.vagrantup.com.</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Every Vagrant development environment requires a box. You can search for</span>
</span><span class='line'>  <span class="c1"># boxes at https://atlas.hashicorp.com/search.</span>
</span><span class='line'>  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">box</span> <span class="o">=</span> <span class="s2">&quot;base&quot;</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Disable automatic box update checking. If you disable this, then</span>
</span><span class='line'>  <span class="c1"># boxes will only be checked for updates when the user runs</span>
</span><span class='line'>  <span class="c1"># `vagrant box outdated`. This is not recommended.</span>
</span><span class='line'>  <span class="c1"># config.vm.box_check_update = false</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Create a forwarded port mapping which allows access to a specific port</span>
</span><span class='line'>  <span class="c1"># within the machine from a port on the host machine. In the example below,</span>
</span><span class='line'>  <span class="c1"># accessing &quot;localhost:8080&quot; will access port 80 on the guest machine.</span>
</span><span class='line'>  <span class="c1"># config.vm.network &quot;forwarded_port&quot;, guest: 80, host: 8080</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Create a private network, which allows host-only access to the machine</span>
</span><span class='line'>  <span class="c1"># using a specific IP.</span>
</span><span class='line'>  <span class="c1"># config.vm.network &quot;private_network&quot;, ip: &quot;192.168.33.10&quot;</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Create a public network, which generally matched to bridged network.</span>
</span><span class='line'>  <span class="c1"># Bridged networks make the machine appear as another physical device on</span>
</span><span class='line'>  <span class="c1"># your network.</span>
</span><span class='line'>  <span class="c1"># config.vm.network &quot;public_network&quot;</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Share an additional folder to the guest VM. The first argument is</span>
</span><span class='line'>  <span class="c1"># the path on the host to the actual folder. The second argument is</span>
</span><span class='line'>  <span class="c1"># the path on the guest to mount the folder. And the optional third</span>
</span><span class='line'>  <span class="c1"># argument is a set of non-required options.</span>
</span><span class='line'>  <span class="c1"># config.vm.synced_folder &quot;../data&quot;, &quot;/vagrant_data&quot;</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Provider-specific configuration so you can fine-tune various</span>
</span><span class='line'>  <span class="c1"># backing providers for Vagrant. These expose provider-specific options.</span>
</span><span class='line'>  <span class="c1"># Example for VirtualBox:</span>
</span><span class='line'>  <span class="c1">#</span>
</span><span class='line'>  <span class="c1"># config.vm.provider &quot;virtualbox&quot; do |vb|</span>
</span><span class='line'>  <span class="c1">#   # Display the VirtualBox GUI when booting the machine</span>
</span><span class='line'>  <span class="c1">#   vb.gui = true</span>
</span><span class='line'>  <span class="c1">#</span>
</span><span class='line'>  <span class="c1">#   # Customize the amount of memory on the VM:</span>
</span><span class='line'>  <span class="c1">#   vb.memory = &quot;1024&quot;</span>
</span><span class='line'>  <span class="c1"># end</span>
</span><span class='line'>  <span class="c1">#</span>
</span><span class='line'>  <span class="c1"># View the documentation for the provider you are using for more</span>
</span><span class='line'>  <span class="c1"># information on available options.</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Define a Vagrant Push strategy for pushing to Atlas. Other push strategies</span>
</span><span class='line'>  <span class="c1"># such as FTP and Heroku are also available. See the documentation at</span>
</span><span class='line'>  <span class="c1"># https://docs.vagrantup.com/v2/push/atlas.html for more information.</span>
</span><span class='line'>  <span class="c1"># config.push.define &quot;atlas&quot; do |push|</span>
</span><span class='line'>  <span class="c1">#   push.app = &quot;YOUR_ATLAS_USERNAME/YOUR_APPLICATION_NAME&quot;</span>
</span><span class='line'>  <span class="c1"># end</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Enable provisioning with a shell script. Additional provisioners such as</span>
</span><span class='line'>  <span class="c1"># Puppet, Chef, Ansible, Salt, and Docker are also available. Please see the</span>
</span><span class='line'>  <span class="c1"># documentation for more information about their specific syntax and use.</span>
</span><span class='line'>  <span class="c1"># config.vm.provision &quot;shell&quot;, inline: &lt;&lt;-SHELL</span>
</span><span class='line'>  <span class="c1">#   sudo apt-get update</span>
</span><span class='line'>  <span class="c1">#   sudo apt-get install -y apache2</span>
</span><span class='line'>  <span class="c1"># SHELL</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>我们可以看到里面有一些很好的注释来帮助我们快速的生成自己需要的配置。这里能看到这个文件的格式是Ruby语法的，因为Vagrant这个工具是用Ruby来实现，所以为了更好的了解这个配置文件我们会在下一章讲解一下基本的Ruby语法。因为Ruby也是学习Chef需要的语言，我会在下一篇blog里讲解一下基础的Chef知识。</p>

<h2>Vagrant需要了解的Ruby语法</h2>

<p>我们通过上面的Vagrantfile看到Ruby里面的注释是用<em>#</em>来开始的。然后我们看到了</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Vagrant</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>这个其实是调用了Vagrant这个mudule上的configure方法，这个方法接受两个参数：第一个参数是2（表示Version），第二个参数是一个代码块(block)，因为根据Ruby的语法, 方法最后一个参数为block的时候我们可以放到括号外面，这种调用也等价于</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Vagrant</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>这是block的两种表示方法，通过这种block的形式我们可以很方便的把一段代码作为参数传给一个方法。这里这个方法的作用就是去设置Vagrant的各项参数。我们可以看到被注释的代码里面也很多再次用到了嵌套的block的方式。<br><br>
需要更多的了解Ruby这门语言的话，这里有个很好的学习Ruby的<a href="http://ruby-doc.com/docs/ProgrammingRuby/">网站</a>，虽然是英文的但是值得一读。</p>

<h2>Box</h2>

<p>现在block的配置里唯一打开注释的就是</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">box</span> <span class="o">=</span> <span class="s2">&quot;base&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Box是你的虚拟机启动时用的base image,所以你就不必从头去设置一个虚拟机。你可以去社区下载已经基本配置好的Box，然后基于它去搭建虚拟机。你可以去<a href="https://atlas.hashicorp.com/boxes/search">HashiCorp&rsquo;s Atlas box catalog</a>去查看社区已有的Box。这个<em>base</em>就是其中一个Box，<em>base</em>是这个Box的id。我们可以用下面的命令去添加一个Box到我们的本地环境中：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>vagrant box add hashicorp/precise32
</span></code></pre></td></tr></table></div></figure>


<p>如果你用的OS是Mac的话，默认下载好的Box会被安装在<em>~/.vagrant.d/boxes</em>。然后我们修改Vagrantfile使用我们导入好的Box，因为base目前是不存在的：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">box</span> <span class="o">=</span> <span class="s2">&quot;hashicorp/precise32&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Commands</h2>

<ul>
<li><em>vagrant up</em> 是启动一个虚拟机，默认的话会在Virtualbox里导入你指定的Box，然后启动。</li>
</ul>


<p>如果这时候你没有用<em>vagrant box add</em>导入Box的话，这时候Vagrant也会自动下载导入对于的Box。这个命令成功执行完毕之后你会在VirtualBox看到多了一个虚拟机。这个虚拟机的名字是<em>vagrant_learning_default_xxxxxx_xxx</em>。虚拟机名字的前面可以看出来是文件夹的名字，后面的default表示是默认的虚拟机因为一个Vagrantfile可以配置多个虚拟机，这个后面我们会看到。<br>
启动好了之后我们可以用<em>vagrant ssh</em>直接进到机器里。
与up相对应的命令有<br></p>

<ul>
<li><em>vagrant destroy</em> 销毁删除一个创建好的虚拟机。一般我们彻底不用的时候才会这样做，更常用的</li>
<li><em>vagrant halt</em> 关闭一个虚拟机，就是把虚拟机关机，这样的话就不会占用Cpu和内存。</li>
</ul>


<p>还有不太常用的命令像 <em>vagrant suspend/resume</em>是挂起或者恢复虚拟机。更多的可以参考官方文档。</p>

<h2>Provider</h2>

<p>Provider是Vagrant用来和不同种类虚拟机通信的驱动，我们在一个Vagrantfile可以配置多种Provider。安装好Vagrant好默认的Provider就是VirtualBox，所以我们在执行命令时不用传入Provider的名字。实际情况下我们有可能在一个Vagrantfile配置多个Provider来应对开发测试的不同阶段，例如我们可以配置一个VirtualBox的Provider做本地开发/测试，然后再定义一个EC2的Provider来部署到Amazon的云里，这样的配置就像下面这样:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provider</span> <span class="s2">&quot;virtualbox&quot;</span> <span class="k">do</span> <span class="o">|</span><span class="n">vb</span><span class="o">|</span>
</span><span class='line'>  <span class="c1"># Display the VirtualBox GUI when booting the machine</span>
</span><span class='line'>  <span class="n">vb</span><span class="o">.</span><span class="n">gui</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Customize the amount of memory on the VM:</span>
</span><span class='line'>  <span class="n">vb</span><span class="o">.</span><span class="n">memory</span> <span class="o">=</span> <span class="s2">&quot;1024&quot;</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Configure the virtual machine name displayed in VirtualBox</span>
</span><span class='line'>  <span class="n">vb</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;vagrant_leanring&quot;</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provider</span> <span class="ss">:aws</span> <span class="k">do</span> <span class="o">|</span><span class="n">aws</span><span class="p">,</span><span class="n">overide</span><span class="o">|</span>
</span><span class='line'>    <span class="n">aws</span><span class="o">.</span><span class="n">security_groups</span>           <span class="o">=</span>  <span class="sx">%w(everything_open)</span>
</span><span class='line'>    <span class="n">aws</span><span class="o">.</span><span class="n">access_key_id</span>             <span class="o">=</span>  <span class="s2">&quot;YOUR KEY&quot;</span>
</span><span class='line'>    <span class="n">aws</span><span class="o">.</span><span class="n">secret_access_key</span>         <span class="o">=</span>  <span class="s2">&quot;YOUR SECRET KEY&quot;</span>
</span><span class='line'>    <span class="n">aws</span><span class="o">.</span><span class="n">ami</span>                       <span class="o">=</span>  <span class="s2">&quot;ami-xxx&quot;</span>
</span><span class='line'>    <span class="n">aws</span><span class="o">.</span><span class="n">instance_type</span>             <span class="o">=</span>  <span class="s2">&quot;m1.medium&quot;</span>
</span><span class='line'>    <span class="n">aws</span><span class="o">.</span><span class="n">keypair_name</span>              <span class="o">=</span>  <span class="s2">&quot;KEYPAIR NAME&quot;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">overide</span><span class="o">.</span><span class="n">ssh</span><span class="o">.</span><span class="n">username</span>              <span class="o">=</span>  <span class="s2">&quot;root&quot;</span>
</span><span class='line'>    <span class="n">overide</span><span class="o">.</span><span class="n">ssh</span><span class="o">.</span><span class="n">private_key_path</span>      <span class="o">=</span>  <span class="s2">&quot;PATH TO YOUR PRIVATE KEY&quot;</span>
</span><span class='line'>    <span class="n">overide</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">box</span>                    <span class="o">=</span>  <span class="s1">&#39;dummy&#39;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>这样配置以后你可以用<em>vagrant up &mdash;provider=aws</em>来远程启动AWS云里的虚拟机。当然之前你需要安装AWS的<a href="https://github.com/mitchellh/vagrant-aws">Provider</a>和配置这个Provider需要的dummy Box。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>vagrant plugin install vagrant-aws
</span><span class='line'>
</span><span class='line'>vagrant box add dummy https://github.com/mitchellh/vagrant-aws/raw/master/dummy.box
</span></code></pre></td></tr></table></div></figure>


<p>接下来的教程我们还是以VirtualBox这个Provider为例来讲解。</p>

<h2>Shared folders</h2>

<p>我们接下来可以打开注释里的<em>config.vm.synced_folder</em>并修改映射到已经存在的一个文件夹。以我的机器为例：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">synced_folder</span> <span class="s2">&quot;../training&quot;</span><span class="p">,</span> <span class="s2">&quot;/vagrant_data&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>这样的话可以把本机Host里的一个文件夹映射到Guest虚拟机里。修改这个设置之后需要重启虚拟机来生效，命令是</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">vagrant</span> <span class="n">reload</span>
</span></code></pre></td></tr></table></div></figure>


<p>这样启动完之后登陆后你可以看到映射的文件夹:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>vagrant ssh
</span><span class='line'>
</span><span class='line'>vagrant@precise32:~<span class="nv">$ </span>ll /vagrant_data/
</span><span class='line'>total 16
</span><span class='line'>drwxr-xr-x  1 vagrant vagrant  238 Jul  4 10:40 ./
</span><span class='line'>drwxr-xr-x 24 root    root    4096 Nov 18 02:25 ../
</span><span class='line'>drwxr-xr-x  1 vagrant vagrant  170 Jul  4 10:39 cookbooks/
</span><span class='line'>drwxr-xr-x  1 vagrant vagrant  272 Jan  8  2016 Docker/
</span><span class='line'>-rw-r--r--  1 vagrant vagrant 8196 Jul  4 10:40 .DS_Store
</span><span class='line'>drwxr-xr-x  1 vagrant vagrant  102 Jul  4 10:39 intro/
</span><span class='line'>drwxr-xr-x  1 vagrant vagrant  102 Apr  5  2016 .vagrant/
</span></code></pre></td></tr></table></div></figure>


<h2>Network</h2>

<p>默认的虚拟机的网络是NAT形式的，我们可以从Vagrant启动的log里看出来：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="o">==</span>&gt; default: Preparing network interfaces based on configuration...
</span><span class='line'>    default: Adapter 1: <span class="nv">nat</span>
</span><span class='line'><span class="o">==</span>&gt; default: Forwarding ports...
</span><span class='line'>    default: <span class="nv">22</span> <span class="o">=</span>&gt; 2202 <span class="o">(</span>adapter 1<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>我们可以看到默认做了一个端口映射，所以我们可以通过访问本机端口2202来访问虚拟机的22(ssh)端口:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>ssh vagrant@127.0.0.1 -p 2202
</span><span class='line'>The authenticity of host <span class="s1">&#39;[127.0.0.1]:2202 ([127.0.0.1]:2202)&#39;</span> can<span class="s1">&#39;t be established.</span>
</span><span class='line'><span class="s1">ECDSA key fingerprint is SHA256:q7StLmS/+YYwF42lL4HQJdMQGcAPpkKgzVlxORTisGE.</span>
</span><span class='line'><span class="s1">Are you sure you want to continue connecting (yes/no)? yes</span>
</span><span class='line'>
</span><span class='line'><span class="s1">vagrant@127.0.0.1&#39;</span>s password:
</span><span class='line'>
</span><span class='line'>Last login: Fri Nov 18 02:26:09 2016 from 10.0.2.2
</span><span class='line'>vagrant@precise32:~<span class="nv">$ </span>
</span></code></pre></td></tr></table></div></figure>


<p>这个就是vagrant ssh的实现原理，默认的用户名是<em>vagrant</em>密码也是<em>vagrant</em>。这样的网络结构做一些简单的部署测试可以的，比方说我们可以定义本机的8080端口映射到虚拟机的80端口：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="s2">&quot;forwarded_port&quot;</span><span class="p">,</span> <span class="ss">guest</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span> <span class="ss">host</span><span class="p">:</span> <span class="mi">8080</span>
</span></code></pre></td></tr></table></div></figure>


<p>修改网络拓扑结构和配置之后也有重启虚拟机。从启动log我们可以看到端口成功映射了</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="o">==</span>&gt; default: Forwarding ports...
</span><span class='line'>    default: <span class="nv">80</span> <span class="o">=</span>&gt; 8080 <span class="o">(</span>adapter 1<span class="o">)</span>
</span><span class='line'>    default: <span class="nv">22</span> <span class="o">=</span>&gt; 2202 <span class="o">(</span>adapter 1<span class="o">)</span>
</span><span class='line'><span class="o">==</span>&gt; default: Running <span class="s1">&#39;pre-boot&#39;</span> VM customizations...
</span></code></pre></td></tr></table></div></figure>


<p>还有一种常用的网络结构是<em>private_network</em>，这种网络结构会创建一个只有主机能和虚拟机通信的私网，这种是通过指定虚拟机内网IP的形式来配置:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="s2">&quot;private_network&quot;</span><span class="p">,</span> <span class="ss">ip</span><span class="p">:</span> <span class="s2">&quot;192.168.33.10&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>这样的配置启动后，Host本机会拥有IP <em>192.168.33.1</em>, 这样本机和虚拟机就是一个网段，通信就没有障碍了。最后一种形式是<em>public_network</em>,这种就是为虚拟机建一个Bridge的网络，相当于虚拟机变成你现有网络里另一台机器。但是这种是受限于网络要求的，像我们公司就是不允许这种网络结构的，你的虚拟机得不到IP。<br>
当然这里网络配置都是针对本地的虚拟机，像是AWS，Openstack这种云里的虚拟机所在自己的Provider配置里来配置的。一般网络结构受限于云和Provider插件支持的类型。</p>

<h2>Provisioner</h2>

<p>现在虚拟机已经启动好了，我们需要配置,部署一些软件上去，这就用到了Provisioner。Vagrantfile也支持多个Provisioner，它们会按配置顺序挨个执行。例如我们可以打开注释里的：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'> <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provision</span> <span class="s2">&quot;shell&quot;</span><span class="p">,</span> <span class="ss">inline</span><span class="p">:</span> <span class="o">&lt;&lt;-</span><span class="no">SHELL</span>
</span><span class='line'><span class="sh">   sudo apt-get update</span>
</span><span class='line'><span class="sh">   sudo apt-get install -y apache2</span>
</span><span class='line'><span class="no"> SHELL</span>
</span></code></pre></td></tr></table></div></figure>


<p>修改完之后我们又要用到一个新命令:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>vagrant provision
</span></code></pre></td></tr></table></div></figure>


<p>这个命令会执行所有定义的provision命令block。之后我们会在控制台看到很长的一段输出，成功执行之后我们就装好了Apache, 我们可以打开浏览器试一试。因为我们已经配置好了端口映射，所以访问本机的8080端口应该能到Apache的欢迎页面。</p>

<blockquote><p>It works!</p>

<p>This is the default web page for this server.</p>

<p>The web server software is running but no content has been added, yet.</p></blockquote>

<br>


<p>这篇教程用到的完整Vagrantfile（去掉了一些注释）如下:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">v</span><span class="c1"># -*- mode: ruby -*-</span>
</span><span class='line'><span class="c1"># vi: set ft=ruby :</span>
</span><span class='line'>
</span><span class='line'><span class="no">Vagrant</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Every Vagrant development environment requires a box. You can search for</span>
</span><span class='line'>  <span class="c1"># boxes at https://atlas.hashicorp.com/search.</span>
</span><span class='line'>  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">box</span> <span class="o">=</span> <span class="s2">&quot;hashicorp/precise32&quot;</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Create a forwarded port mapping which allows access to a specific port</span>
</span><span class='line'>  <span class="c1"># within the machine from a port on the host machine. In the example below,</span>
</span><span class='line'>  <span class="c1"># accessing &quot;localhost:8080&quot; will access port 80 on the guest machine.</span>
</span><span class='line'>  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="s2">&quot;forwarded_port&quot;</span><span class="p">,</span> <span class="ss">guest</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span> <span class="ss">host</span><span class="p">:</span> <span class="mi">8080</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Share an additional folder to the guest VM. The first argument is</span>
</span><span class='line'>  <span class="c1"># the path on the host to the actual folder. The second argument is</span>
</span><span class='line'>  <span class="c1"># the path on the guest to mount the folder. And the optional third</span>
</span><span class='line'>  <span class="c1"># argument is a set of non-required options.</span>
</span><span class='line'>  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">synced_folder</span> <span class="s2">&quot;../training&quot;</span><span class="p">,</span> <span class="s2">&quot;/vagrant_data&quot;</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Provider-specific configuration so you can fine-tune various</span>
</span><span class='line'>  <span class="c1"># backing providers for Vagrant. These expose provider-specific options.</span>
</span><span class='line'>  <span class="c1"># Example for VirtualBox:</span>
</span><span class='line'>  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provider</span> <span class="s2">&quot;virtualbox&quot;</span> <span class="k">do</span> <span class="o">|</span><span class="n">vb</span><span class="o">|</span>
</span><span class='line'>    <span class="c1"># Display the VirtualBox GUI when booting the machine</span>
</span><span class='line'>    <span class="n">vb</span><span class="o">.</span><span class="n">gui</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1"># Customize the amount of memory on the VM:</span>
</span><span class='line'>    <span class="n">vb</span><span class="o">.</span><span class="n">memory</span> <span class="o">=</span> <span class="s2">&quot;1024&quot;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1"># Configure the virtual machine name displayed in VirtualBox</span>
</span><span class='line'>    <span class="n">vb</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;vagrant_leanring&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provider</span> <span class="ss">:aws</span> <span class="k">do</span> <span class="o">|</span><span class="n">aws</span><span class="p">,</span><span class="n">overide</span><span class="o">|</span>
</span><span class='line'>      <span class="n">aws</span><span class="o">.</span><span class="n">security_groups</span>           <span class="o">=</span>  <span class="sx">%w(everything_open)</span>
</span><span class='line'>      <span class="n">aws</span><span class="o">.</span><span class="n">access_key_id</span>             <span class="o">=</span>  <span class="s2">&quot;YOUR KEY&quot;</span>
</span><span class='line'>      <span class="n">aws</span><span class="o">.</span><span class="n">secret_access_key</span>         <span class="o">=</span>  <span class="s2">&quot;YOUR SECRET KEY&quot;</span>
</span><span class='line'>      <span class="n">aws</span><span class="o">.</span><span class="n">ami</span>                       <span class="o">=</span>  <span class="s2">&quot;ami-xxx&quot;</span>
</span><span class='line'>      <span class="n">aws</span><span class="o">.</span><span class="n">instance_type</span>             <span class="o">=</span>  <span class="s2">&quot;m1.medium&quot;</span>
</span><span class='line'>      <span class="n">aws</span><span class="o">.</span><span class="n">keypair_name</span>              <span class="o">=</span>  <span class="s2">&quot;KEYPAIR NAME&quot;</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">overide</span><span class="o">.</span><span class="n">ssh</span><span class="o">.</span><span class="n">username</span>              <span class="o">=</span>  <span class="s2">&quot;root&quot;</span>
</span><span class='line'>      <span class="n">overide</span><span class="o">.</span><span class="n">ssh</span><span class="o">.</span><span class="n">private_key_path</span>      <span class="o">=</span>  <span class="s2">&quot;PATH TO YOUR PRIVATE KEY&quot;</span>
</span><span class='line'>      <span class="n">overide</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">box</span>                    <span class="o">=</span>  <span class="s1">&#39;dummy&#39;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Enable provisioning with a shell script. Additional provisioners such as</span>
</span><span class='line'>  <span class="c1"># Puppet, Chef, Ansible, Salt, and Docker are also available. Please see the</span>
</span><span class='line'>  <span class="c1"># documentation for more information about their specific syntax and use.</span>
</span><span class='line'>  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provision</span> <span class="s2">&quot;shell&quot;</span><span class="p">,</span> <span class="ss">inline</span><span class="p">:</span> <span class="o">&lt;&lt;-</span><span class="no">SHELL</span>
</span><span class='line'><span class="sh">    sudo apt-get update</span>
</span><span class='line'><span class="sh">    sudo apt-get install -y apache2</span>
</span><span class='line'><span class="no">  SHELL</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<br><br>


<p>这篇教程到这就告一段落了，我想我还会写第二部分讲述如何用一个Vagrantfile配置多个虚拟机，然后讲完Chef后还会写一个结合Vagrant和Chef的教程。</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Sean Guo</span></span>

      








  


<time datetime="2016-11-16T11:48:43+08:00" pubdate data-updated="true">Nov 16<span>th</span>, 2016</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/tool/'>tool</a>, <a class='category' href='/blog/categories/vagrant/'>vagrant</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://www.seanguo.com/blog/2016/11/16/vagrant-ru-men/" data-via="" data-counturl="http://www.seanguo.com/blog/2016/11/16/vagrant-ru-men/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/11/27/itunes-backup-location/" title="Previous Post: itunes的备份之后的文件在哪儿">&laquo; itunes的备份之后的文件在哪儿</a>
      
      
        <a class="basic-alignment right" href="/blog/2017/01/17/ru-he-gou-jian-hei-ping-guo-hackintosh/" title="Next Post: 如何构建黑苹果(Hackintosh)">如何构建黑苹果(Hackintosh) &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2017/02/17/chefjie-shao/">Chef 介绍 Part1 Setup</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/01/17/ru-he-gou-jian-hei-ping-guo-hackintosh/">如何构建黑苹果(Hackintosh)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/11/16/vagrant-ru-men/">Vagrant 入门</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/27/itunes-backup-location/">Itunes的备份之后的文件在哪儿</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/11/27/nosql-database-compare/">NoSql Database Compare</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/seanguo">@seanguo</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'seanguo',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>




<section id="tag-cloud" class="aside-module grid__item one-whole lap-one-half">
  <h1 class="title delta">Tag Cloud</h1>
    <span id="tag-cloud"></span> 
</section>
  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2017 - Sean Guo -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'seanguo';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://www.seanguo.com/blog/2016/11/16/vagrant-ru-men/';
        var disqus_url = 'http://www.seanguo.com/blog/2016/11/16/vagrant-ru-men/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
